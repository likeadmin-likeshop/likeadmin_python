import{_ as x,D as h,C as S,v as R,t as U,F as q}from"./element-plus.ef27c94c.js";import{d as N,a as I,b as P,c as T}from"./department.86ccbbf2.js";import{P as M}from"./index.12c77328.js";import{u as O}from"./useDictOptions.2a4a45b6.js";import{f as L}from"./index.4eaac8c2.js";import{d as X,s as E,r as $,e as j,a1 as z,o as F,c as G,X as a,P as d,u as t,O as H,T as J,a as _}from"./@vue.a137a740.js";const K={class:"edit-popup"},Q=_("div",{class:"form-tips"},"\u9ED8\u8BA4\u4E3A0\uFF0C \u6570\u503C\u8D8A\u5927\u8D8A\u6392\u524D",-1),ae=X({__name:"edit",emits:["success","close"],setup(W,{expose:D,emit:m}){const c=E(),n=E(),i=$("add"),B=j(()=>i.value=="edit"?"\u7F16\u8F91\u90E8\u95E8":"\u65B0\u589E\u90E8\u95E8"),u=z({id:"",pid:"",name:"",duty:"",mobile:"",sort:0,isStop:0}),b={pid:[{required:!0,message:"\u8BF7\u9009\u62E9\u4E0A\u7EA7\u90E8\u95E8",trigger:["change"]}],name:[{required:!0,message:"\u8BF7\u8F93\u5165\u90E8\u95E8\u540D\u79F0",trigger:["blur"]}],duty:[{required:!0,message:"\u8BF7\u8F93\u5165\u8D1F\u8D23\u4EBA\u59D3\u540D",trigger:["blur"]}],mobile:[{required:!0,message:"\u8BF7\u8F93\u5165\u8054\u7CFB\u7535\u8BDD",trigger:["blur"]},{validator:(l,e,o)=>{if(e){const r=/^[1][3,4,5,6,7,8,9][0-9]{9}$/;if(console.log(r.test(e)),r.test(e))o();else return o(new Error("\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u624B\u673A\u53F7"))}else return o()},trigger:["blur"]}]},{optionsData:g}=O({dept:{api:N}}),V=async()=>{var l,e;await((l=c.value)==null?void 0:l.validate()),i.value=="edit"?await I(u):await P(u),(e=n.value)==null||e.close(),L.msgSuccess("\u64CD\u4F5C\u6210\u529F"),m("success")},v=(l="add")=>{var e;i.value=l,(e=n.value)==null||e.open()},f=(l,e)=>{for(const o in u)l[o]!=null&&l[o]!=null?(u[o]=l[o],o=="sort"&&e==0&&(u[o]=0,u.isStop=0)):u[o]=l.is_stop},A=async l=>{const e=await T({id:l.id});f(e)},y=()=>{m("close")};return D({open:v,setFormData:f,getDetail:A}),(l,e)=>{const o=x,r=h,p=S,C=R,w=U,k=q;return F(),G("div",K,[a(M,{ref_key:"popupRef",ref:n,title:t(B),async:!0,width:"550px",onConfirm:V,onClose:y},{default:d(()=>[a(k,{ref_key:"formRef",ref:c,model:t(u),"label-width":"84px",rules:b},{default:d(()=>[t(u).pid!==0?(F(),H(r,{key:0,label:"\u4E0A\u7EA7\u90E8\u95E8",prop:"pid"},{default:d(()=>[a(o,{class:"flex-1",modelValue:t(u).pid,"onUpdate:modelValue":e[0]||(e[0]=s=>t(u).pid=s),data:t(g).dept,clearable:"","node-key":"id",props:{value:"id",label:"name"},"check-strictly":"","default-expand-all":!0,placeholder:"\u8BF7\u9009\u62E9\u4E0A\u7EA7\u90E8\u95E8"},null,8,["modelValue","data"])]),_:1})):J("",!0),a(r,{label:"\u90E8\u95E8\u540D\u79F0",prop:"name"},{default:d(()=>[a(p,{modelValue:t(u).name,"onUpdate:modelValue":e[1]||(e[1]=s=>t(u).name=s),placeholder:"\u8BF7\u8F93\u5165\u90E8\u95E8\u540D\u79F0",clearable:"",maxlength:100},null,8,["modelValue"])]),_:1}),a(r,{label:"\u8D1F\u8D23\u4EBA",prop:"duty"},{default:d(()=>[a(p,{modelValue:t(u).duty,"onUpdate:modelValue":e[2]||(e[2]=s=>t(u).duty=s),placeholder:"\u8BF7\u8F93\u5165\u8D1F\u8D23\u4EBA\u59D3\u540D",clearable:"",maxlength:30},null,8,["modelValue"])]),_:1}),a(r,{label:"\u8054\u7CFB\u7535\u8BDD",prop:"mobile"},{default:d(()=>[a(p,{modelValue:t(u).mobile,"onUpdate:modelValue":e[3]||(e[3]=s=>t(u).mobile=s),placeholder:"\u8BF7\u8F93\u5165\u8054\u7CFB\u7535\u8BDD",clearable:""},null,8,["modelValue"])]),_:1}),a(r,{label:"\u6392\u5E8F",prop:"sort"},{default:d(()=>[_("div",null,[a(C,{modelValue:t(u).sort,"onUpdate:modelValue":e[4]||(e[4]=s=>t(u).sort=s),min:0,max:9999},null,8,["modelValue"]),Q])]),_:1}),a(r,{label:"\u90E8\u95E8\u72B6\u6001",prop:"isStop"},{default:d(()=>[a(w,{modelValue:t(u).isStop,"onUpdate:modelValue":e[5]||(e[5]=s=>t(u).isStop=s),"active-value":0,"inactive-value":1},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["title"])])}}});export{ae as _};
